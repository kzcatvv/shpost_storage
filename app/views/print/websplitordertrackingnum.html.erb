<!DOCTYPE HTML>
<html>
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<%= stylesheet_link_tag "application", :media => "all" %>
<%= javascript_include_tag :defaults %>
      <%= javascript_include_tag "application" %>

<object id="LODOP_OB" classid="clsid:2105C259-1E0C-4534-8141-A753534CB4CA" width=0 height=0> 
	<embed id="LODOP_EM" type="application/x-print-lodop" width=0 height=0 pluginspage="install_lodop.exe"></embed>
</object>

<script language="javascript" type="text/javascript">

function splitordertracking_preview(){
  LODOP=getLodop(document.getElementById('LODOP_OB'),document.getElementById('LODOP_EM'));
  <% if @transport_type=='gnxb'%>
    LODOP.PRINT_INITA("-5.5mm","-3mm","232mm","130.7mm","tracking");
    LODOP.SET_PRINT_PAGESIZE(1,"230mm","127mm","tracking");
    LODOP.ADD_PRINT_TEXT("41mm","86.8mm","25.1mm","6.6mm",'<%= @order.province %><%= @order.city %>');
    LODOP.ADD_PRINT_TEXT("49.5mm","36.5mm","26.5mm","5.3mm",'<%= @order.customer_name %>');
    LODOP.ADD_PRINT_TEXT("48.7mm","82.8mm","27.8mm","6.6mm",'<%= @order.customer_phone %>');
    LODOP.ADD_PRINT_TEXT("62.7mm","44.2mm","65.4mm","5.3mm",'<%= @order.customer_address %>');
    LODOP.ADD_PRINT_TEXT("41mm","25.9mm","4mm","5.3mm",'<%= @order.customer_postcode.nil? ? "" : @order.customer_postcode[0] %>');
    LODOP.ADD_PRINT_TEXT("41mm","33.1mm","4.5mm","5.3mm",'<%= @order.customer_postcode.nil? ? "" : @order.customer_postcode[1] %>');
    LODOP.ADD_PRINT_TEXT("41mm","39.7mm","4.8mm","5.3mm",'<%= @order.customer_postcode.nil? ? "" : @order.customer_postcode[2] %>');
    LODOP.ADD_PRINT_TEXT("41mm","46.3mm","3.4mm","5.3mm",'<%= @order.customer_postcode.nil? ? "" : @order.customer_postcode[3] %>');
    LODOP.ADD_PRINT_TEXT("41mm","52.4mm","4.8mm","5.3mm",'<%= @order.customer_postcode.nil? ? "" : @order.customer_postcode[4] %>');
    LODOP.ADD_PRINT_TEXT("41mm","59mm","4mm","5.3mm",'<%= @order.customer_postcode.nil? ? "" : @order.customer_postcode[5] %>');
    LODOP.ADD_PRINT_TEXT("75.7mm","83.1mm","27.8mm","5.3mm",'<%= @order.business.phone %>');
    LODOP.ADD_PRINT_TEXT("83.1mm","44.4mm","64.8mm","5.3mm",'<%= @order.business.name %>');
    LODOP.ADD_PRINT_TEXT("89.2mm","45.8mm","65.1mm","5.3mm",'<%= @order.business.name %>');
    LODOP.ADD_PRINT_TEXT("96.6mm","37.3mm","71.4mm","5.3mm","邮政客服电话：4008215071");
    LODOP.ADD_PRINT_TEXT("104mm","133.4mm","23.8mm","6.6mm",'<%= @order.business.name %>');
    content='';
    <% @order.order_details.each do |j| %>
      content=content+'<%= j.name %>  数量：<%= j.amount %>\n'
    <% end %>
    LODOP.ADD_PRINT_TEXT("46.3mm","114.6mm","42.3mm","34.4mm",content);
    LODOP.ADD_PRINT_TEXT("46.6mm","161.4mm","33.1mm","6.6mm",CurentTime(0,1));
    LODOP.ADD_PRINT_TEXT("59.5mm","162.7mm","33.1mm","5.3mm",'<%= current_user.unit.name %>');
    LODOP.ADD_PRINT_TEXT("75.9mm","171.4mm","21.4mm","5.3mm",'<%= @order.total_weight %>');
    LODOP.ADD_PRINT_TEXT("31.8mm","161.7mm","37.3mm","5.3mm",'<%= @order.no %>'); 
    //LODOP.PREVIEW();  
    LODOP.PRINT();  
  <% elsif @transport_type=='ems' %>
    LODOP.PRINT_INITA("0mm","0mm","230.2mm","127.3mm","tracking");
    LODOP.SET_PRINT_PAGESIZE(1,"230mm","127mm","tracking");
    LODOP.ADD_PRINT_TEXT("25.7mm","29.6mm","27.8mm","5.3mm",'<%= @order.business.name %>');
    LODOP.ADD_PRINT_TEXT("25.4mm","72.2mm","31.8mm","5.3mm",'<%= @order.business.phone %>');
    LODOP.ADD_PRINT_TEXT("33.6mm","33.3mm","80.4mm","10.6mm",'<%= @order.business.name %>');
    LODOP.ADD_PRINT_TEXT("46.6mm","87.3mm","4.8mm","5.3mm","2");
    LODOP.ADD_PRINT_TEXT("46.6mm","92.3mm","4.5mm","5.3mm","0");
    LODOP.ADD_PRINT_TEXT("46.6mm","97.9mm","4mm","5.3mm","0");
    LODOP.ADD_PRINT_TEXT("46.6mm","103.2mm","4.5mm","5.3mm","4");
    LODOP.ADD_PRINT_TEXT("46.6mm","108mm","3.7mm","5.3mm","3");
    LODOP.ADD_PRINT_TEXT("46.6mm","113mm","5.3mm","5.3mm","5");
    LODOP.ADD_PRINT_TEXT("56.6mm","32mm","23.8mm","5.3mm",'<%= @order.customer_name %>');
    LODOP.ADD_PRINT_TEXT("56.1mm","74.1mm","41mm","5.3mm",'<%= @order.customer_phone %>');
    LODOP.ADD_PRINT_TEXT("67.7mm","29.4mm","86mm","13.2mm",'<%= @order.customer_address %>');
    LODOP.ADD_PRINT_TEXT("82.6mm","33.6mm","42.3mm","5.3mm",'<%= @order.province %><%= @order.city %>');
    LODOP.ADD_PRINT_TEXT("83.9mm","87.6mm","4.2mm","5.3mm",'<%= @order.customer_postcode[0] %>');
    LODOP.ADD_PRINT_TEXT("83.9mm","93.1mm","4mm","5.3mm",'<%= @order.customer_postcode[1] %>');
    LODOP.ADD_PRINT_TEXT("83.9mm","98.4mm","4mm","5.3mm",'<%= @order.customer_postcode[2] %>');
    LODOP.ADD_PRINT_TEXT("83.9mm","103.2mm","3.7mm","5.3mm",'<%= @order.customer_postcode[3] %>');
    LODOP.ADD_PRINT_TEXT("83.9mm","108.2mm","3.7mm","5.3mm",'<%= @order.customer_postcode[4] %>');
    LODOP.ADD_PRINT_TEXT("83.9mm","112.7mm","4.5mm","5.3mm",'<%= @order.customer_postcode[5] %>');
    LODOP.ADD_PRINT_TEXT("107.7mm","47.1mm","4mm","5.3mm","X");
    LODOP.ADD_PRINT_TEXT("113.8mm","35.7mm","4.5mm","4mm","X");
    LODOP.ADD_PRINT_TEXT("49.2mm","178.3mm","27.8mm","6.6mm",'<%= @order.business.name %>');
    LODOP.ADD_PRINT_TEXT("57.4mm","169.3mm","10.1mm","5.3mm",'<%= Time.now.year %>');
    LODOP.ADD_PRINT_TEXT("57.4mm","182.8mm","5.8mm","5.3mm",'<%= Time.now.month %>');
    LODOP.ADD_PRINT_TEXT("57.7mm","191.6mm","5.3mm","5.3mm",'<%= Time.now.day %>');
    content='';
    <% @order.order_details.each do |j| %>
      content=content+'<%= j.name %>  数量：<%= j.amount %>,    '
    <% end %>
    LODOP.ADD_PRINT_TEXT("97.9mm","32.8mm","85.5mm","9.3mm",content);
    //LODOP.PREVIEW();  
    LODOP.PRINT();
  <% elsif @transport_type=='tcsd' %>
    LODOP.PRINT_INITA("0mm","0mm","229.7mm","127mm","tracking");
    LODOP.SET_PRINT_PAGESIZE(1,"230mm","127mm","tracking");
    LODOP.ADD_PRINT_TEXT("35.5mm","36.2mm","29.1mm","5.3mm",'<%= current_user.unit.name %>'+'函件局');
    LODOP.ADD_PRINT_TEXT("35.5mm","81.8mm","29.1mm","5.3mm",CurentTime(0,1));
    LODOP.ADD_PRINT_TEXT("42.1mm","44.7mm","40.5mm","5.3mm",'<%= @order.customer_name %>');
    LODOP.ADD_PRINT_TEXT("47.6mm","41mm","61.1mm","5.3mm",'<%= @order.customer_phone %>');
    LODOP.ADD_PRINT_TEXT("60.6mm","39.2mm","72mm","7.9mm",'<%= @order.customer_address %>');
    LODOP.ADD_PRINT_TEXT("70.1mm","85.2mm","26.5mm","5.3mm",'<%= @order.customer_postcode %>');
    LODOP.ADD_PRINT_TEXT("81.8mm","38.9mm","64.6mm","5.3mm",'<%= @order.business.phone %>');
    LODOP.ADD_PRINT_TEXT("88.4mm","39.4mm","64mm","5.3mm",'<%= @order.business.name %>');
    LODOP.ADD_PRINT_TEXT("96mm","41mm","66.1mm","6.6mm",'<%= @order.business.name %>');
    content='';
    <% @order.order_details.each do |j| %>
      content=content+'<%= j.name %>  数量：<%= j.amount %>,    '
    <% end %>
    LODOP.ADD_PRINT_TEXT("41mm","115.1mm","33.6mm","28.6mm",content);
    LODOP.ADD_PRINT_TEXT("69.8mm","123mm","16.9mm","5.3mm",'<%= @order.total_weight %>');

    //LODOP.PREVIEW();  
    LODOP.PRINT();
  <% end %>
};
</script>

</head>
  
  <body onLoad="splitordertracking_preview();window.opener=null;window.open('','_top'); window.top.close();">
  
  	</body>
</html>